<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Silent Hour ‚Äì Novel App</title>

<style>
body {
  background:#0f1220;
  color:#eaeaf0;
  font-family:Inter, Arial, sans-serif;
  padding:24px;
}
.container { max-width:800px; margin:auto; }
.card {
  background:#171a2f;
  padding:28px;
  border-radius:16px;
  margin-bottom:24px;
}
a { color:#6c7cff; text-decoration:none; }
h1,h2 { font-family:Georgia; }
input { 
  width:100%; 
  padding:10px; 
  margin:10px 0; 
  border-radius:8px; 
  border:1px solid #6c7cff; 
  background:#0f1220; 
  color:#eaeaf0; 
}
button { 
  width:48%; 
  padding:10px; 
  margin:5px 1%; 
  border:none; 
  border-radius:8px; 
  background:#6c7cff; 
  color:white; 
  cursor:pointer; 
}
button:hover { background:#515aff; }
.google-btn {
  background:#db4437; 
  width:100%; 
  margin-top:10px;
  color:white;
  font-weight:bold;
}
.google-btn:hover { background:#c13527; }
.message { margin-top:10px; font-size:0.9rem; }
.hidden { display:none; }
</style>
</head>

<body>
<div class="container">

<h1>üìñ The Silent Hour</h1>
<p>Written by Tieg ‚Ä¢ Weekly updates</p>

<!-- üîë LOGIN / SIGN UP FORM -->
<div class="card" id="loginCard">
  <h2>üîë Login / Sign Up</h2>
  <input type="email" id="email" placeholder="Email">
  <input type="password" id="password" placeholder="Password">
  <input type="password" id="confirmPassword" placeholder="Confirm Password (Sign Up Only)">
  <button onclick="login()">Login</button>
  <button onclick="signup()">Sign Up</button>
  <p style="margin-top:8px;">
    <a href="#" onclick="forgotPassword()" style="color:#6c7cff; text-decoration:underline;">Forgot Password?</a>
  </p>
  <button class="google-btn" onclick="googleSignIn()">Sign in with Google</button>
  <div class="message" id="msg"></div>
</div>

<!-- Logout button -->
<div id="logoutCard" class="card hidden">
  <button onclick="logout()">Logout</button>
</div>

<!-- CONTENT VISIBLE AFTER LOGIN -->
<div id="content" class="hidden">

<div class="card">
<h2>üìö Chapters</h2>
<p><a href="chapter1.html">Chapter 1: When the Clock Stopped</a></p>
<p><a href="chapter2.html">Chapter 2: The Invitation</a></p>
<p><a href="chapter3.html">Chapter 3: The Second That Broke Time</a></p>
</div>  

<div class="card">
<h2>üîî Notice</h2>
<p>This is an original novel. New chapters are added every week.</p>
</div>  

<div class="card">
<h2>‚ÑπÔ∏è App Info</h2>
<p>
<a href="about.html">About</a> ‚Ä¢
<a href="privacy.html">Privacy Policy</a> ‚Ä¢
<span style="color:#a5a8c6;">Terms ‚Äì Coming Soon</span>
</p>
</div>  

<p style="text-align:center;font-size:0.85rem;">
¬© 2026 The Silent Hour
</p>

</div>
</div>

<!-- ================= FIREBASE LOGIN/SIGNUP ================= -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
import { 
  getAuth, 
  createUserWithEmailAndPassword, 
  signInWithEmailAndPassword, 
  onAuthStateChanged, 
  signOut, 
  sendPasswordResetEmail, 
  GoogleAuthProvider, 
  signInWithPopup 
} from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyD9PdBAZzQeZbb4z1_vC-Nlc9v46xVMQ6E",
  authDomain: "my-novel-app-ce68b.firebaseapp.com",
  projectId: "my-novel-app-ce68b",
  storageBucket: "my-novel-app-ce68b.appspot.com",
  messagingSenderId: "1040625911547",
  appId: "1:1040625911547:web:0ba4fc967c05664fdd925e",
  measurementId: "G-76F21G6ZT5"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const provider = new GoogleAuthProvider();

// Friendly error messages only
function getFriendlyError(error) {
  switch (error.code) {
    case "auth/invalid-email": return "Please enter a valid email address.";
    case "auth/user-not-found":
    case "auth/wrong-password": return "Email or password is incorrect.";
    case "auth/email-already-in-use": return "This email is already registered.";
    case "auth/weak-password": return "Password must be at least 6 characters.";
    default: return "Something went wrong. Please try again.";
  }
}

// Show/hide content based on login state
onAuthStateChanged(auth, (user) => {
  if (user) {
    document.getElementById("loginCard").classList.add("hidden");
    document.getElementById("content").classList.remove("hidden");
    document.getElementById("logoutCard").classList.remove("hidden");
  } else {
    document.getElementById("loginCard").classList.remove("hidden");
    document.getElementById("content").classList.add("hidden");
    document.getElementById("logoutCard").classList.add("hidden");
  }
});

// Email/Password login
window.login = () => {
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;

  signInWithEmailAndPassword(auth, email, password)
    .then(userCredential => {
      document.getElementById("msg").style.color = "green";
      document.getElementById("msg").innerText = "Login successful! Welcome " + userCredential.user.email;
    })
    .catch(err => {
      document.getElementById("msg").style.color = "red";
      document.getElementById("msg").innerText = getFriendlyError(err);
    });
};

// Email/Password signup
window.signup = () => {
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;
  const confirmPassword = document.getElementById("confirmPassword").value;

  if (password !== confirmPassword) {
    document.getElementById("msg").style.color = "red";
    document.getElementById("msg").innerText = "Passwords do not match.";
    return;
  }

  createUserWithEmailAndPassword(auth, email, password)
    .then(userCredential => {
      document.getElementById("msg").style.color = "green";
      document.getElementById("msg").innerText = "Sign up successful! Welcome " + userCredential.user.email;
    })
    .catch(err => {
      document.getElementById("msg").style.color = "red";
      document.getElementById("msg").innerText = getFriendlyError(err);
    });
};

// Logout
window.logout = () => {
  signOut(auth).then(() => {
    document.getElementById("msg").style.color = "green";
    document.getElementById("msg").innerText = "Logged out successfully.";
  });
};

// Forgot Password
window.forgotPassword = () => {
  const email = document.getElementById("email").value;
  if (!email) {
    document.getElementById("msg").style.color = "red";
    document.getElementById("msg").innerText = "Please enter your email to reset password.";
    return;
  }

  sendPasswordResetEmail(auth, email)
    .then(() => {
      document.getElementById("msg").style.color = "green";
      document.getElementById("msg").innerText = `Password reset email sent to ${email}. Check your inbox.`;
    })
    .catch(err => {
      document.getElementById("msg").style.color = "red";
      document.getElementById("msg").innerText = getFriendlyError(err);
    });
};

// Google Sign-In
window.googleSignIn = () => {
  signInWithPopup(auth, provider)
    .then((result) => {
      const user = result.user;
      document.getElementById("msg").style.color = "green";
      document.getElementById("msg").innerText = "Login successful! Welcome " + (user.displayName || user.email);
    })
    .catch((err) => {
      document.getElementById("msg").style.color = "red";
      document.getElementById("msg").innerText = "Google sign-in failed. Please try again.";
    });
};
</script>

</body>
</html>